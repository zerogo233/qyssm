<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <!-- import CSS -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <style>
    </style>
</head>
<body>
<div id="app">
    <div>
        <h3 style="text-align:center;">类目</h3>
        <div id="category">{{category.id}}, {{category.name}}</div>
        <button @click="addCategory('新增的分类')">添加分类</button>
        <div v-for="category in categoryList">
            {{category.name}}
            <button @click="updateCategory(category.id, '修改过分类')">修改</button>
            <button @click="delete(category.id)">删除</button>
        </div>
    </div>
</div>
</body>
<!-- import Vue before Element -->
<script src="https://unpkg.com/vue/dist/vue.js"></script>
<!-- import JavaScript -->
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>


<script>

    function queryParams(data, isPrefix) {
        isPrefix = isPrefix ? isPrefix : false
        var prefix = isPrefix ? '?' : ''
        var _result = []
        for (var key in data) {
            var value = data[key]
            // 去掉为空的参数
            if (['', undefined, null].includes(value)) {
                continue
            }
            if (value.constructor === Array) {
                value.forEach(function (_value) {
                    _result.push(encodeURIComponent(key) + '[]=' + encodeURIComponent(_value))
                })
            } else {
                _result.push(encodeURIComponent(key) + '=' + encodeURIComponent(value))
            }
        }

        return _result.length ? prefix + _result.join('&') : ''
    }

    new Vue({
        el: '#app',
        data: function () {
            return {
                visible: false,
                form: {
                    username: '',
                    password: ''
                },
                category: {},
                categoryList: []
            }
        },
        methods: {
            getCategory: function(id) {
                var that = this
                axios.get('/api/admin/category?id='+id).then(function (res) {
                    that.category = res.data.data
                })
            },
            getCategoryList: function() {
                var that = this
                axios.get('/api/admin/category/list').then(function (res) {
                    that.categoryList = res.data.data
                })
            },
            addCategory:function (name) {
                var that = this
                axios.post('/api/admin/category', queryParams({
                    name: name
                })).then(function (res) {
                    // 判断是否成功
                    //
                })
            },
            updateCategory:function (id, name) {
                var that = this
                axios.put('/api/admin/category', queryParams({
                    id:id,
                    name:name
                })).then(function (res) {
                    // ...
                })
            },
            delete: function (id) {
                var that = this
                axios.delete('/api/admin/category', queryParams({
                    id:id
                })).then(function (res) {
                   // ..
                })
            },
        }
    })


</script>
</html>
